{% extends "base.html" %}

{% block title %}Админ-панель - Платформа инициатив{% endblock %}

{% block content %}
<div class="admin-container">
    <h2 style="color: #5d5d7a; margin-bottom: 30px; text-align: center;">
        <i class="fas fa-cog"></i> Панель администратора
    </h2>
    
    <div style="background: #f0f9ff; padding: 20px; border-radius: 10px; margin-bottom: 30px;">
        <h4 style="color: #5d5d7a; margin-bottom: 10px;">
            <i class="fas fa-info-circle"></i> Информация администратора
        </h4>
        <p style="margin-bottom: 5px;"><strong>Логин:</strong> admin</p>
        <p><strong>Пароль:</strong> admin123</p>
        <p style="color: #666; font-size: 0.9rem; margin-top: 10px;">Для проверки задания преподавателем</p>
    </div>
    
    <div class="admin-section">
        <h3><i class="fas fa-users"></i> Пользователи ({{ users|length }})</h3>
        
        <table class="admin-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Логин</th>
                    <th>Дата регистрации</th>
                    <th>Админ</th>
                    <th>Инициатив</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td>{{ user.id }}</td>
                    <td>{{ user.username }}</td>
                    <td>{{ user.created_at.strftime('%d.%m.%Y %H:%M') }}</td>
                    <td>
                        {% if user.is_admin %}
                            <span class="badge admin">Да</span>
                        {% else %}
                            <span style="color: #666;">Нет</span>
                        {% endif %}
                    </td>
                    <td>{{ user.initiatives|length }}</td>
                    <td>
                        {% if not user.is_admin %}
                            <a href="{{ url_for('admin_delete_user', user_id=user.id) }}" 
                               class="btn-delete"
                               onclick="return confirm('Удалить пользователя {{ user.username }}? Все его инициативы будут удалены!')">
                                <i class="fas fa-trash"></i> Удалить
                            </a>
                        {% else %}
                            <span style="color: #666; font-size: 0.9rem;">Системный</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div class="admin-section">
        <h3><i class="fas fa-lightbulb"></i> Инициативы ({{ initiatives|length }})</h3>
        
        <table class="admin-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Заголовок</th>
                    <th>Автор</th>
                    <th>Дата</th>
                    <th>Рейтинг</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody>
                {% for initiative in initiatives %}
                <tr>
                    <td>{{ initiative.id }}</td>
                    <td>{{ initiative.title[:50] }}{% if initiative.title|length > 50 %}...{% endif %}</td>
                    <td>{{ initiative.author.username }}</td>
                    <td>{{ initiative.created_at.strftime('%d.%m.%Y') }}</td>
                    <td>
                        <span class="score {{ 'positive' if initiative.score >= 0 else 'negative' }}" style="padding: 5px 10px; font-size: 0.9rem;">
                            {{ initiative.score }}
                        </span>
                    </td>
                    <td>
                        <a href="{{ url_for('delete', initiative_id=initiative.id) }}" 
                           class="btn-delete"
                           onclick="return confirm('Удалить инициативу «{{ initiative.title[:30] }}...»?')">
                            <i class="fas fa-trash"></i> Удалить
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div style="text-align: center; margin-top: 30px;">
        <a href="{{ url_for('index') }}" class="btn-primary" style="display: inline-block; width: auto;">
            <i class="fas fa-arrow-left"></i> Вернуться на главную
        </a>
    </div>
</div>
{% endblock %}